---
name: terraform-code-reviewer
description: Terraformコードの包括的レビューを実行するコマンド。セキュリティ、ベストプラクティス、パフォーマンス、コスト最適化を総合的に評価し、実用的な改善提案を提供。
tools: Read, Write, Edit
model: inherit
---

# Terraform コード包括レビューコマンド

このコマンドは、`terraform-code-reviewer-agent`と連携してTerraformコードの包括的なレビューを実行し、セキュリティ、ベストプラクティス、パフォーマンス、コスト最適化の観点から実用的な改善提案を提供します。

## レビュープロセス

### フェーズ1: コード分析
- Terraformコードの構造と依存関係を分析
- リソース定義、変数、出力、モジュール構成を検証
- セキュリティ、パフォーマンス、コストの課題を特定
- レビューの優先順位を決定

### フェーズ2: 包括的レビュー実行
- **セキュリティレビュー**: セキュリティグループ、IAM、暗号化設定の検証
- **ベストプラクティス**: Terraformの公式ガイドラインに基づく検証
- **パフォーマンス**: リソース設定、データソース使用の最適化
- **コスト最適化**: リソースサイズ、ライフサイクル設定の検証
- **コード品質**: 可読性、保守性、再利用性の評価

### フェーズ3: 結果統合と提案
- 各観点の結果を統合
- 重複する指摘を整理・統合
- 優先度と影響度を調整して最終フィードバックを生成
- 実装可能な改善ロードマップを提供

## 統合フィードバック形式

### 🔴 重大な問題（即座に修正が必要）
- **セキュリティリスク**: 公開されたリソース、不適切なIAM設定
- **コストリスク**: 不要な高額リソース、適切でないライフサイクル設定
- **可用性リスク**: 単一障害点、不適切な冗長性設定
- **コンプライアンス**: 規制要件に違反する設定

### 🟡 推奨修正（品質向上）
- **ベストプラクティス**: Terraformの公式推奨事項に基づく改善
- **パフォーマンス**: より効率的なリソース設定
- **保守性**: コードの可読性と再利用性の向上
- **モニタリング**: ログとメトリクス設定の改善

### 🟢 追加提案（完成度向上）
- **セキュリティ強化**: 追加のセキュリティ層の提案
- **運用性**: デプロイメントとメンテナンスの改善
- **スケーラビリティ**: 将来の拡張性を考慮した設計
- **ドキュメント**: コードの理解を助けるドキュメント追加

## 使用方法

### 基本的な使用方法

```bash
/terraform-code-reviewer
```
Terraformコード全体を包括的にレビューします。

### 特定のファイルをレビュー

```bash
/terraform-code-reviewer --file main.tf
```
指定したTerraformファイルのみを重点的にレビューします。

### 特定の観点でレビュー

```bash
/terraform-code-reviewer --focus security
```
セキュリティに特化したレビューを実行します（security/cost/performance/best-practices）。

### レビューレベルの指定

```bash
/terraform-code-reviewer --level strict
```
より厳格なレビューを実行します（strict/normal/quick）。

## 出力例

### レビューサマリー

```text
📊 Terraformコードレビュー結果サマリー
- 重大な問題: 2件
- 推奨修正: 8件
- 追加提案: 5件
- 総合評価: B+ (良好、セキュリティとコスト最適化推奨)
```

### 詳細フィードバック
各問題について、以下の情報を提供：
- 問題の概要と影響度
- 現在のコード内容
- 具体的な修正提案（コード例付き）
- 修正理由と期待される効果
- 関連するTerraform公式ドキュメント

## レビュー観点

### セキュリティ
- セキュリティグループの適切な設定
- IAMロールとポリシーの最小権限原則
- 暗号化設定（保存時・転送時）
- ネットワークセキュリティ設定
- シークレット管理

### ベストプラクティス
- リソース命名規則
- タグ付け戦略
- モジュール化と再利用性
- 状態管理の適切な設定
- バージョン管理

### パフォーマンス
- リソースサイズの最適化
- データソースの効率的な使用
- 並行処理の設定
- キャッシュ戦略

### コスト最適化
- 不要なリソースの特定
- 適切なライフサイクル設定
- リザーブドインスタンスの活用
- ストレージクラスの最適化

## 注意事項

- **セキュリティ優先**: セキュリティリスクは最優先で対応
- **実用性重視**: 実際の運用で実装可能な改善提案
- **段階的改善**: 優先度に基づいた段階的な改善ロードマップ
- **ドキュメント参照**: Terraform公式ドキュメントとの整合性確保

## エージェント連携

### terraform-code-reviewer-agent

- **担当**: Terraformコードの詳細分析と改善提案
- **対象**: セキュリティ、ベストプラクティス、パフォーマンス、コスト最適化
- **出力**: 具体的なコード修正提案と実装ガイド